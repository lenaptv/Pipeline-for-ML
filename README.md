# Пайплан для процесса машинного обучения
Предположим, что с определенной периодичностью (ежемесячно, ежеквартально и т.п.) у вас появляются новые данные, и появляется необходимость обновить прогноз, в том числе актуализировать ранее выбранную модель машинного обучения.

В таком случае было бы здорово автоматизировать данный процесс: предобработку данных, обнаружение категориальных признаков и их трансформацию при помощи OneHotEncoder(), разбивку датасета на подвыборки,  поиск наилучшего алгоритма на основе кросс-валидации, финальный расчет accuracy на тестовой выборке и сохранение вновь выбранной модели. Именно это и делает данная программа.

## Содержание

1. [Глава I](#глава-i) \
    1.1. [Цели](#Цели)
2. [Глава II](#глава-ii) \
    2.1. [Что делает данная программа](#Что-делает-данная-программа)
3. [Глава III](#глава-iii) \
    3.1. [Запуск и работа программы](#Запуск-и-работа-программы)
   

## Глава I
### Цели

Данная программа автоматизирует процесс машинного обучения для следующего случая.
Рассмотрим пример, если бы для школы, обучающей ИТ-профессиям, было бы важно предсказать день недели, в котором был сделан определенный коммит в зависимости от следующих признаков: студента, номера лабораторной работы, часа и порядкового номера попытки.
При этом есть датасет со следующими данными: `uid` - ник студента, `labname` - название лабораторной работы, `numTrials` - порядковый номер попытки, `timestamp` - временная метка с датой и точным временем коммита.
Каждый месяц датасет существенно меняется в виду новой информации и требуется пересматривать подход к прогнозированию дня недели коммита и обновлять прогноз.

## Глава II
### Что делает данная программа

Основу данной программы представляет собой скрипт на языке Python `base_classes.py`, который содержит необходимые классы и методы.

Первые три кастомных класса-трансформера выполняют следующие задачи:
- Вытащить из колонки `timestamp` час и день недели (в виде цифры), а затем удалить ставший ненужным столбец `timestamp`.
- Обнаружить все категориальные признаки и выполнить их трансформацию при помощи OneHotEncoder(), а затем удалить ставшие ненужными первоначальные столбцы с категориальными признаками.
- Выделить в отдельный series столбец с целевой переменной.
- Выполнить разбивку датасета на подвыборки: тренировочную, валидационную и тестовую.

Следующий класс принимает на вход список экземпляров GridSearchCV и словарь, в котором ключами являются индексы из этого списка, а значениями – названия моделей.
Затем данный класс выполняет поиск наилучшего набора гиперпараметров на основе кросс-валидации для каждой заданной модели и возвращает следующую информацию: название каждой модели, наилучший набор гиперпараметров (в виде словаря) для данного алгоритма, значение accuracy на основе кросс-валидации. 

И наконец, финальный класс выдает значение accuracy на тестовой подвыборке для вновь выбранной модели и сохраняет данную модель. 

Скрипт `pipeline.py`запускает работу программы, в нем также прописываются алгоритмы и экземпляры для GridSearchCV, среди которых будет проведен поиск наилучшей модели на основе кросс-валидации. Финальное решение о выборе модели остается за пользователем - после предоставленной информации о результатах поиска наилучшего сочетания гиперпараметров для каждого алгоритма программа попросит ввести название выбранной модели и соответствующие гиперпараметры.

## Глава III
### Запуск и работа программы

 - Для запуска программы скачайте файлы из данного репозитория, разархивируйте папку `data` целиком
 - Также подключите в в среде разработки библиотеки из файла requirements.txt
 - Откройт в среде разработки файл с классами и методами: `base_classes.py`
 - Затем запустите файл с запуском программы: `pipeline.py`
 В данном файле уже считывается датасет-пример, его можно поменять, но тк данная программа предобработки прописана для определенного случая, то новый датасет должен быть таким же по структуре как и файл из примера.
 А вот список моделей и соответствующих вариантов гиперпараметров для Greadsearch можно обновить по усмотрению.
 - В процессе работы программа попросит вас принять решение о выборе модели, ввести ее название и наилучшие параметры


